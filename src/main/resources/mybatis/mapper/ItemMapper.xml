<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="team.project.cooldown.mybatis.ItemMapper">
         <select id="selectItemAttach"  resultType="ItemAttach">
           select iano,item_id,fname,fsize from itemattach
         </select>
    <select id="selectItemCombine"  resultType="ItemCombine">
        SELECT i.item_id, i.category, i.itemname, i.price, i.likes, i.info, i.stock, ia.iano, ia.fname, ia.fsize
        FROM item i

        JOIN itemattach ia ON i.item_id = ia.item_id

        <if test="idx != null">
            WHERE i.item_id = #{idx}
        </if>


        <if test="sort == 'recent'">
            ORDER BY i.item_id ASC
        </if>
        <if test="sort == 'like'">
            ORDER BY i.likes DESC
        </if>
        <if test="sort == 'max_price'">
            ORDER BY i.price DESC
        </if>
        <if test="sort == 'min_price'">
            ORDER BY i.price ASC
        </if>
        <if test="sort == 'abc'">
            ORDER BY i.itemname ASC
        </if>
        <if test="sort == 'descabc'">
            ORDER BY i.itemname DESC
        </if>
    </select>

    <select id="selectItemCombine_d"  resultType="ItemCombine">
        SELECT i.item_id, i.category, i.itemname, i.price, i.likes, i.info, i.stock, ia.iano, ia.fname, ia.fsize
        FROM item i
        JOIN itemattach ia ON i.item_id = ia.item_id
        where category = 'digbus_goods'
        <if test="idx != null">
            AND i.item_id = #{idx}
        </if>
        <if test="sort == 'recent'">
            ORDER BY i.item_id ASC
        </if>
        <if test="sort == 'like'">
            ORDER BY i.likes DESC
        </if>
        <if test="sort == 'max_price'">
            ORDER BY i.price DESC
        </if>
        <if test="sort == 'min_price'">
            ORDER BY i.price ASC
        </if>
        <if test="sort == 'abc'">
            ORDER BY i.itemname ASC
        </if>
        <if test="sort == 'descabc'">
            ORDER BY i.itemname DESC
        </if>
    </select>
    <select id="selectItemCombine_c"  resultType="ItemCombine">
        SELECT i.item_id, i.category, i.itemname, i.price, i.likes, i.info, i.stock, ia.iano, ia.fname, ia.fsize
        FROM item i
        JOIN itemattach ia ON i.item_id = ia.item_id where category = 'campingitem'
        <if test="idx != null">
            and i.item_id = #{idx}
        </if>
        <if test="sort == 'recent'">
            ORDER BY i.item_id ASC
        </if>
        <if test="sort == 'like'">
            ORDER BY i.likes DESC
        </if>
        <if test="sort == 'max_price'">
            ORDER BY i.price DESC
        </if>
        <if test="sort == 'min_price'">
            ORDER BY i.price ASC
        </if>
        <if test="sort == 'abc'">
            ORDER BY i.itemname ASC
        </if>
        <if test="sort == 'descabc'">
            ORDER BY i.itemname DESC
        </if>
    </select>
    <select id="selectItemCombine_h"  resultType="ItemCombine">
        SELECT i.item_id, i.category, i.itemname, i.price, i.likes, i.info, i.stock, ia.iano, ia.fname, ia.fsize
        FROM item i
        JOIN itemattach ia ON i.item_id = ia.item_id where category = 'hikinhitem'
        <if test="idx != null">
            and i.item_id = #{idx}
        </if>
        <if test="sort == 'recent'">
            ORDER BY i.item_id ASC
        </if>
        <if test="sort == 'like'">
            ORDER BY i.likes DESC
        </if>
        <if test="sort == 'max_price'">
            ORDER BY i.price DESC
        </if>
        <if test="sort == 'min_price'">
            ORDER BY i.price ASC
        </if>
        <if test="sort == 'abc'">
            ORDER BY i.itemname ASC
        </if>
        <if test="sort == 'descabc'">
            ORDER BY i.itemname DESC
        </if>
    </select>
    <select id="selectItemCombine_b"  resultType="ItemCombine">
        SELECT i.item_id, i.category, i.itemname, i.price, i.likes, i.info, i.stock, ia.iano, ia.fname, ia.fsize
        FROM item i
        JOIN itemattach ia ON i.item_id = ia.item_id where category = 'bikeitem'
        <if test="idx != null">
            and i.item_id = #{idx}
        </if>
        <if test="sort == 'recent'">
            ORDER BY i.item_id ASC
        </if>
        <if test="sort == 'like'">
            ORDER BY i.likes DESC
        </if>
        <if test="sort == 'max_price'">
            ORDER BY i.price DESC
        </if>
        <if test="sort == 'min_price'">
            ORDER BY i.price ASC
        </if>
        <if test="sort == 'abc'">
            ORDER BY i.itemname ASC
        </if>
        <if test="sort == 'descabc'">
            ORDER BY i.itemname DESC
        </if>
    </select>
    <select id="selectItemCombine_r"  resultType="ItemCombine">
        SELECT i.item_id, i.category, i.itemname, i.price, i.likes, i.info, i.stock, ia.iano, ia.fname, ia.fsize
        FROM item i
        JOIN itemattach ia ON i.item_id = ia.item_id where category = 'runningitem'
        <if test="idx != null">
            and i.item_id = #{idx}
        </if>
        <if test="sort == 'recent'">
            ORDER BY i.item_id ASC
        </if>
        <if test="sort == 'like'">
            ORDER BY i.likes DESC
        </if>
        <if test="sort == 'max_price'">
            ORDER BY i.price DESC
        </if>
        <if test="sort == 'min_price'">
            ORDER BY i.price ASC
        </if>
        <if test="sort == 'abc'">
            ORDER BY i.itemname ASC
        </if>
        <if test="sort == 'descabc'">
            ORDER BY i.itemname DESC
        </if>
    </select>
    
    <!--cart-->
    <insert id="insertCart" >
        insert into cart (u_id,item_id,count) values (#{u_id},#{item_id},#{count})
    </insert>

    <select id="selectCart"  resultType="Cart">
        select * from cart where u_id = #{u_id}
    </select>









</mapper>